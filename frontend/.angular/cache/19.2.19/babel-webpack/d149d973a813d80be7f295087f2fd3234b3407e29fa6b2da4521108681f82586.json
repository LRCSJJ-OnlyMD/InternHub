{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../services/auth.service';\n/**\n * Guard to protect routes based on user roles.\n * Implements role-based access control (RBAC) on the frontend.\n * Checks JWT token for user role before allowing route activation.\n */\nexport const roleGuard = (route, state) => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  const expectedRoles = route.data['roles'];\n  if (!authService.isLoggedIn()) {\n    router.navigate(['/login'], {\n      queryParams: {\n        returnUrl: state.url\n      }\n    });\n    return false;\n  }\n  const userRole = authService.getUserRole();\n  if (!userRole || !expectedRoles.includes(userRole)) {\n    // User doesn't have required role, redirect to unauthorized page\n    router.navigate(['/unauthorized']);\n    return false;\n  }\n  return true;\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}