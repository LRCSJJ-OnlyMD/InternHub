{"ast":null,"code":"import { BehaviorSubject, interval } from 'rxjs';\nimport { tap, switchMap, startWith } from 'rxjs/operators';\nimport { API_CONFIG } from '../shared/api-config';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let NotificationService = /*#__PURE__*/(() => {\n  class NotificationService {\n    constructor(http) {\n      this.http = http;\n      this.unreadCountSubject = new BehaviorSubject(0);\n      this.unreadCount$ = this.unreadCountSubject.asObservable();\n      // Poll for new notifications every 30 seconds\n      interval(30000).pipe(startWith(0), switchMap(() => this.getUnreadCount())).subscribe();\n    }\n    getNotifications(page = 0, size = 20) {\n      return this.http.get(`${API_CONFIG.NOTIFICATIONS}?page=${page}&size=${size}`);\n    }\n    getUnreadNotifications() {\n      return this.http.get(`${API_CONFIG.NOTIFICATIONS}/unread`);\n    }\n    getUnreadCount() {\n      return this.http.get(`${API_CONFIG.NOTIFICATIONS}/unread/count`).pipe(tap(response => this.unreadCountSubject.next(response.count)));\n    }\n    markAsRead(notificationId) {\n      return this.http.put(`${API_CONFIG.NOTIFICATIONS}/${notificationId}/read`, {}).pipe(tap(() => {\n        const currentCount = this.unreadCountSubject.value;\n        this.unreadCountSubject.next(Math.max(0, currentCount - 1));\n      }));\n    }\n    markAllAsRead() {\n      return this.http.put(`${API_CONFIG.NOTIFICATIONS}/mark-all-read`, {}).pipe(tap(() => this.unreadCountSubject.next(0)));\n    }\n    deleteNotification(notificationId) {\n      return this.http.delete(`${API_CONFIG.NOTIFICATIONS}/${notificationId}`);\n    }\n    refreshUnreadCount() {\n      this.getUnreadCount().subscribe();\n    }\n    static {\n      this.ɵfac = function NotificationService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || NotificationService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: NotificationService,\n        factory: NotificationService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return NotificationService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}